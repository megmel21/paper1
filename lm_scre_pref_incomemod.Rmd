---
title: "lm_scre_pref_incomemod"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(DAAG)
library(sjPlot)
```

#震災関連の予算を引く----
```{r}
economic_quake <- read.csv(file = "C:/Users/megme/Dropbox/厚労科研/Koshi/scrate and gender gap/variables/economic_quake.csv", header = T, stringsAsFactor = F)
prefcode <- read.csv(file = "C:/Users/megme/Dropbox/厚労科研/Koshi/scrate and gender gap/variables/prefcode.csv", header = T, stringsAsFactor = F) %>% 
  select(pref,citycode)
economic_quake_coded <- left_join(economic_quake, prefcode, by = c("citycode")) %>% 
  select(year,pref, everything())

economic_quake_coded %>% 
  rename(income = 歳入合計,
         kofuzei_quake = 地方交付税_震災復興特別交付税,
         kokko = 国庫支出金,
         kokko_quake = 国庫支出金_東日本大震災復興交付金) %>% 
  select(year,pref,citycode,income,kofuzei_quake,kokko,kokko_quake) %>% 
  group_by(pref,year) %>% 
  summarise(income = sum(income,na.rm = T),
            kofuzei_quake = sum(kofuzei_quake,na.rm = T),
            kokko = sum(kokko,na.rm = T),
            kokko_quake = sum(kokko_quake, na.rm = T)) -> economic_quake_citytopref

economic_quake_citytopref$pref %>% 
  str_remove_all(pattern = "県|府") %>% 
  str_replace_all(pattern = "東京都", replacement = "東京") ->economic_quake_citytopref$pref


merged_variables4 <- merge(merged_variables3, economic_quake_citytopref, by = c("pref", "year")) %>% 
  select(pref, year,incomediffexpenceperpop_milyen, kokko_quake, kokko, kofuzei_quake, income,everything())

merged_variables4 %>% 
  mutate(kokko_quakeperpop = kokko_quake/pop_totalage,
         kofuzei_quakeperpop = kofuzei_quake/pop_totalage,
         kokkoperpop = kokko/pop_totalage,
         incomeperpop_citytopref = income/pop_totalage,
         incomemod1 = incomeperpop_milyen - (kokko_quakeperpop/1000000),
         incomemod2 = incomeperpop_milyen - (kofuzei_quakeperpop/1000000),
         incomemod3 = incomeperpop_milyen - (kokko_quakeperpop/1000000) - (kofuzei_quakeperpop/1000000),
         incomemod4 = incomeperpop_milyen - (kokkoperpop/1000000),
         incomediffexpenceperpop_milyen_mod1 = incomemod1 - expenceperpop_milyen,
         incomediffexpenceperpop_milyen_mod2 = incomemod2 - expenceperpop_milyen,
         incomediffexpenceperpop_milyen_mod3 = incomemod3 - expenceperpop_milyen,
         incomediffexpenceperpop_milyen_mod4 = incomemod4 - expenceperpop_milyen) %>% 
  select(pref, year,incomediffexpenceperpop_milyen,
         incomediffexpenceperpop_milyen_mod1,
         incomediffexpenceperpop_milyen_mod2,
         incomediffexpenceperpop_milyen_mod3,
         incomediffexpenceperpop_milyen_mod4,
         kokko_quakeperpop, kokkoperpop, kofuzei_quakeperpop, everything())  -> merged_variables4

merged_variables4$incomeperpop_citytopref %>% summary()
merged_variables4$incomeperpop_milyen %>% summary()

merged_variables4 %>% 
  mutate(diff = (incomeperpop_milyen*1000000)-incomeperpop_citytopref,
         ratio = diff/(incomeperpop_milyen*1000000)*100  ) -> test
test$ratio %>% summary()

```
同じデータのはずのインカム同士でsummaryをみると多少のずれがある。
市町村を県に直した奴のほうが多少少ない。
→元のインカムから、市町村を自分で直したインカムを引いた差を求める(code中の"diff")
で、元のインカムとこのdiffのパーセンテージを求める(code中の"ratio")

→すると、平均で5%いかないくらいの変化率のよう。まあ許容範囲内として、今回の震災関連予算もあらかたとらえられていると判断する。


```{r}
merged_variables4$incomediffexpenceperpop_milyen　%>% summary()
merged_variables4$incomediffexpenceperpop_milyen_mod1 %>% summary()
merged_variables4$incomediffexpenceperpop_milyen_mod2 %>% summary()
merged_variables4$incomediffexpenceperpop_milyen_mod3 %>% summary()
merged_variables4$incomediffexpenceperpop_milyen_mod4 %>% summary()
```

市町村単位でみると、国庫支出金がないとincome-expenceはマイナスになるんだな。

incomediffexpenceperpop_milyen_mod1... 国庫支出金の震災関連だけを引いたもの
incomediffexpenceperpop_milyen_mod2...交付税の震災関連だけを引いたもの
incomediffexpenceperpop_milyen_mod3... 国庫支出金と交付税の震災関連をひいたもの
incomediffexpenceperpop_milyen_mod4...国庫支出金自体をひいたもの（そもそも検診に国庫支出金が出ていないので）

#up40s----
cscr_govgc_2016

```{r setting dataset}
merge1_incomemod <- merge(mergecscr_h28_up40, merged_variables4, by = c("pref","sex"), all = T) %>% 
  select(year,pref,sex, everything() )
names(merge1_incomemod)[5:44] %>% 
  paste0(., "_2016") ->names(merge1_incomemod)[5:44]


merge1_incomemod %>% 
  select( -contains("_lc"), -contains("lc_"),
          -contains("_crc"), -contains("crc_"),
          -contains("_bc"), -contains("bc_"),
          -contains("_cvc"), -contains("cvc_")) ->merge1_incomemod_gc

merge1_incomemod %>% 
  select( -contains("_gc"), -contains("gc_"),
          -contains("_crc"), -contains("crc_"),
          -contains("_bc"), -contains("bc_"),
          -contains("_cvc"), -contains("cvc_")) ->merge1_incomemod_lc

merge1_incomemod %>% 
  select( -contains("_lc"), -contains("lc_"),
          -contains("_gc"), -contains("gc_"),
          -contains("_bc"), -contains("bc_"),
          -contains("_cvc"), -contains("cvc_")) ->merge1_incomemod_crc

merge1_incomemod %>% 
  select( -contains("_lc"), -contains("lc_"),
          -contains("_crc"), -contains("crc_"),
          -contains("_gc"), -contains("gc_"),
          -contains("_cvc"), -contains("cvc_")) ->merge1_incomemod_bc


merge1_incomemod_gc %>% 
  filter(pref != "熊本") %>% 
  filter(year == "2016") -> gc2016_incomemod 

merge1_incomemod_lc %>% 
  filter(pref != "熊本") %>% 
  filter(year == "2016") -> lc2016_incomemod 

merge1_incomemod_crc %>% 
  filter(pref != "熊本") %>% 
  filter(year == "2016") -> crc2016_incomemod 

merge1_incomemod_bc %>% 
  filter(pref != "熊本") %>% 
  filter(year == "2016") -> bc2016_incomemod

```

試しにプロット
```{r}
gc2016_incomemod %>% 
  filter(sex == "male") %>% 
  filter(year=="2016") %>% 
ggplot(., aes(x = incomediffexpenceperpop_milyen, y = cscr_govgc_2016, colour = haslimit_gc)) +
  geom_point()+ 
  geom_text(aes(label=pref))+
  stat_smooth(method = "lm", se = TRUE, colour = "blue", size = 0.5) -> gc2016_male_scr_haslimit_gov

ggsave(file ="C:/Users/megme/Documents/paper1/plots/gc2016_male_scr_haslimit_gov.png", plot = gc2016_male_scr_haslimit_gov, height = 10, width = 15)

gc2016_incomemod %>% 
  filter(sex == "male") %>% 
  filter(year=="2016") %>% 
ggplot(., aes(x = incomediffexpenceperpop_milyen_mod1, y = cscr_govgc_2016, colour = haslimit_gc)) +
  geom_point()+ 
  geom_text(aes(label=pref))+
  stat_smooth(method = "lm", se = TRUE, colour = "blue", size = 0.5) -> gc2016_male_incomemod1_scr_haslimit_gov


ggsave(file ="C:/Users/megme/Documents/paper1/plots/gc2016_male_incomemod1_scr_haslimit_gov.png", plot = gc2016_male_incomemod1_scr_haslimit_gov, height = 10, width = 15)

gc2016_incomemod %>% 
  filter(sex == "male") %>% 
  filter(year=="2016") %>% 
ggplot(., aes(x = incomediffexpenceperpop_milyen_mod2, y = cscr_govgc_2016, colour = haslimit_gc)) +
  geom_point()+ 
  geom_text(aes(label=pref))+
  stat_smooth(method = "lm", se = TRUE, colour = "blue", size = 0.5) -> gc2016_male_incomemod2_scr_haslimit_gov


ggsave(file ="C:/Users/megme/Documents/paper1/plots/gc2016_male_incomemod2_scr_haslimit_gov.png", plot = gc2016_male_incomemod2_scr_haslimit_gov, height = 10, width = 15)


gc2016_incomemod %>% 
  filter(sex == "male") %>% 
  filter(year=="2016") %>% 
ggplot(., aes(x = incomediffexpenceperpop_milyen_mod3, y = cscr_govgc_2016, colour = haslimit_gc)) +
  geom_point()+ 
  geom_text(aes(label=pref))+
  stat_smooth(method = "lm", se = TRUE, colour = "blue", size = 0.5) -> gc2016_male_incomemod3_scr_haslimit_gov


ggsave(file ="C:/Users/megme/Documents/paper1/plots/gc2016_male_incomemod3_scr_haslimit_gov.png", plot = gc2016_male_incomemod3_scr_haslimit_gov, height = 10, width = 15)

gc2016_incomemod %>% 
  filter(sex == "male") %>% 
  filter(year=="2016") %>% 
ggplot(., aes(x = incomediffexpenceperpop_milyen_mod4, y = cscr_govgc_2016, colour = haslimit_gc)) +
  geom_point()+ 
  geom_text(aes(label=pref))+
  stat_smooth(method = "lm", se = TRUE, colour = "blue", size = 0.5) -> gc2016_male_incomemod4_scr_haslimit_gov


ggsave(file ="C:/Users/megme/Documents/paper1/plots/gc2016_male_incomemod4_scr_haslimit_gov.png", plot = gc2016_male_incomemod4_scr_haslimit_gov, height = 10, width = 15)
```


国庫支出金を省くと結構変わるな。
mod1, 2, 3で見ていくのがいいみたいだ。
```{r}

gc2016_incomemod %>% 
  filter(sex == "male") %>% 
  filter(year=="2016") %>% 
ggplot(., aes(x = kokko_quakeperpop, y = cscr_govgc_2016, colour = haslimit_gc)) +
  geom_point()+ 
  geom_text(aes(label=pref)) -> kokko_quake_to_cscrgc


ggsave(file ="C:/Users/megme/Documents/paper1/plots/kokko_quake_to_cscrgc.png", plot = kokko_quake_to_cscrgc, height = 10, width = 15)


gc2016_incomemod %>% 
  filter(sex == "male") %>% 
  filter(year=="2016") %>% 
ggplot(., aes(x = kofuzei_quakeperpop, y = cscr_govgc_2016, colour = haslimit_gc)) +
  geom_point()+ 
  geom_text(aes(label=pref)) -> kofuzei_quake_to_cscrgc


ggsave(file ="C:/Users/megme/Documents/paper1/plots/kofuzei_quake_to_cscrgc.png", plot = kofuzei_quake_to_cscrgc, height = 10, width = 15)


gc2016_incomemod %>% 
  filter(sex == "male") %>% 
  filter(year=="2016") %>% 
ggplot(., aes(x = kokko_quakeperpop+ kofuzei_quakeperpop, y = cscr_govgc_2016, colour = haslimit_gc)) +
  geom_point()+ 
  geom_text(aes(label=pref)) -> quake_mod3_to_cscrgc


ggsave(file ="C:/Users/megme/Documents/paper1/plots/quake_mod3_to_cscrgc.png", plot = quake_mod3_to_cscrgc, height = 10, width = 15)
```


# こっから重回帰　　mod1----


# gc male ----
cscr_totalgc_2016 + cscr_totalgc_mod_2016 + cscr_govgc_2016 + cscr_govgc_mod_2016 +
cscr_workgc_2016 +    cscr_workgc_mod_2016 +cscr_othergc_2016 + cscr_othergc_mod_2016 +


 incomediffexpenceperpop_milyen_mod1 + incomediffexpenceperpop_milyen_mod1*haslimit_gc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_gc +  forfree_gc +   
othercity_gc +  offhours_gc + asmrgc2018


```{r lm cscrgc_total male}

res_gc2016_male_total_incomemod1 <- lm(data = gc2016_incomemod, cscr_totalgc_2016 ~ 
                              incomediffexpenceperpop_milyen_mod1 + incomediffexpenceperpop_milyen_mod1*haslimit_gc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_gc +  forfree_gc +   
othercity_gc +  offhours_gc + asmrgc2018
,subset =  sex == "male")
summary(res_gc2016_male_total_incomemod1)
vif(res_gc2016_male_total_incomemod1)
step(res_gc2016_male_total_incomemod1)

```




```{r cscrgc_gov male}


res_gc2016_male_gov_incomemod1 <- lm(data = gc2016_incomemod, cscr_govgc_2016 ~  
                              incomediffexpenceperpop_milyen_mod1 + incomediffexpenceperpop_milyen_mod1*haslimit_gc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_gc +  forfree_gc +   
othercity_gc +  offhours_gc + asmrgc2018
, subset =  sex == "male")
summary(res_gc2016_male_gov_incomemod1)
vif(res_gc2016_male_gov_incomemod1)
step(res_gc2016_male_gov_incomemod1)


```

```{r cscrgc_work male}


res_gc2016_male_work_incomemod1 <- lm(data = gc2016_incomemod, cscr_workgc_2016 ~ 
                                        incomediffexpenceperpop_milyen_mod1 + incomediffexpenceperpop_milyen_mod1*haslimit_gc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_gc +  forfree_gc +   
othercity_gc +  offhours_gc + asmrgc2018
, subset =  sex == "male")
summary(res_gc2016_male_work_incomemod1)
vif(res_gc2016_male_work_incomemod1)
step(res_gc2016_male_work_incomemod1)

```



```{r}
gc2016data2016_male_incomemod1 <- tab_model(res_gc2016_male_total_incomemod1,res_gc2016_male_gov_incomemod1,res_gc2016_male_work_incomemod1,
                                            dv.labels = c("total_male","gov_male", "work_male"),
                      string.pred = "Coeffcient",
                      string.ci = "Conf. Int (95%)",
                      string.p = "P-Value", 
                      linebreak = TRUE,
                      digits = 3, digits.p = 2,
                      title = "crude screening rate (GC, 2016, income-kokko_quake), data = 2016",
                      file = "C:\\Users\\megme\\Documents\\cleaning variables\\gc2016data2016_male_incomemod1.html" )
gc2016data2016_male_incomemod1
```

    


# gc female ----
cscr_totalgc_2016 + cscr_totalgc_mod_2016 + cscr_govgc_2016 + cscr_govgc_mod_2016 +
cscr_workgc_2016 +    cscr_workgc_mod_2016 +cscr_othergc_2016 + cscr_othergc_mod_2016 +


incomediffexpenceperpop_milyen_mod1 + incomediffexpenceperpop_milyen_mod1*haslimit_gc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_gc +  forfree_gc +   
othercity_gc +  offhours_gc + asmrgc2018
 
```{r lm cscrgc_total female}

res_gc2016_female_total_incomemod1 <- lm(data = gc2016_incomemod, cscr_totalgc_2016 ~ 
                                          incomediffexpenceperpop_milyen_mod1 + incomediffexpenceperpop_milyen_mod1*haslimit_gc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_gc +  forfree_gc +   
othercity_gc +  offhours_gc + asmrgc2018

,subset =  sex == "female")
summary(res_gc2016_female_total_incomemod1)
vif(res_gc2016_female_total_incomemod1)
step(res_gc2016_female_total_incomemod1)
```




```{r cscrgc_gov female}


res_gc2016_female_gov_incomemod1 <- lm(data = gc2016_incomemod, cscr_govgc_2016 ~ 
                                        incomediffexpenceperpop_milyen_mod1 + incomediffexpenceperpop_milyen_mod1*haslimit_gc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_gc +  forfree_gc +   
othercity_gc +  offhours_gc + asmrgc2018
, subset =  sex == "female")
summary(res_gc2016_female_gov_incomemod1)

vif(res_gc2016_female_gov_incomemod1)
step(res_gc2016_female_gov_incomemod1)


```

```{r cscrgc_work female}


res_gc2016_female_work_incomemod1 <- lm(data = gc2016_incomemod, cscr_workgc_2016 ~  
                                       incomediffexpenceperpop_milyen_mod1 + incomediffexpenceperpop_milyen_mod1*haslimit_gc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_gc +  forfree_gc +   
othercity_gc +  offhours_gc + asmrgc2018
, subset =  sex == "female")
summary(res_gc2016_female_work_incomemod1)
vif(res_gc2016_female_work_incomemod1)
step(res_gc2016_female_work_incomemod1)

```



```{r}
gc2016data2016_female_incomemod1 <- tab_model(res_gc2016_female_total_incomemod1,res_gc2016_female_gov_incomemod1,res_gc2016_female_work_incomemod1,
                                              dv.labels = c("total_female","gov_female", "work_female"),
                      string.pred = "Coeffcient",
                      string.ci = "Conf. Int (95%)",
                      string.p = "P-Value", 
                      linebreak = TRUE,
                      digits = 3, digits.p = 2,
                      title = "crude screening rate (GC, 2016, income-kokko_quake), data = 2016",
                      file = "C:\\Users\\megme\\Documents\\cleaning variables\\gc2016data2016_female_incomemod1.html" )
gc2016data2016_female_incomemod1
```



# lc male ----
cscr_totallc_2016 + cscr_totallc_mod_2016 + cscr_govlc_2016 + cscr_govlc_mod_2016 +
cscr_worklc_2016 +    cscr_worklc_mod_2016 +cscr_otherlc_2016 + cscr_otherlc_mod_2016 +


 incomediffexpenceperpop_milyen_mod1 + incomediffexpenceperpop_milyen_mod1*haslimit_lc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_lc +  forfree_lc +   
othercity_lc +  offhours_lc + asmrlc2018


```{r lm cscrlc_total male}

res_lc2016_male_total_incomemod1 <- lm(data = lc2016_incomemod, cscr_totallc_2016 ~ 
                              incomediffexpenceperpop_milyen_mod1 + incomediffexpenceperpop_milyen_mod1*haslimit_lc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_lc +  forfree_lc +   
othercity_lc +  offhours_lc + asmrlc2018
,subset =  sex == "male")
summary(res_lc2016_male_total_incomemod1)
vif(res_lc2016_male_total_incomemod1)
step(res_lc2016_male_total_incomemod1)

```




```{r cscrlc_gov male}


res_lc2016_male_gov_incomemod1 <- lm(data = lc2016_incomemod, cscr_govlc_2016 ~  
                              incomediffexpenceperpop_milyen_mod1 + incomediffexpenceperpop_milyen_mod1*haslimit_lc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_lc +  forfree_lc +   
othercity_lc +  offhours_lc + asmrlc2018
, subset =  sex == "male")
summary(res_lc2016_male_gov_incomemod1)
vif(res_lc2016_male_gov_incomemod1)
step(res_lc2016_male_gov_incomemod1)


```

```{r cscrlc_work male}


res_lc2016_male_work_incomemod1 <- lm(data = lc2016_incomemod, cscr_worklc_2016 ~ 
                                        incomediffexpenceperpop_milyen_mod1 + incomediffexpenceperpop_milyen_mod1*haslimit_lc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_lc +  forfree_lc +   
othercity_lc +  offhours_lc + asmrlc2018
, subset =  sex == "male")
summary(res_lc2016_male_work_incomemod1)
vif(res_lc2016_male_work_incomemod1)
step(res_lc2016_male_work_incomemod1)

```



```{r}
lc2016data2016_male_incomemod1 <- tab_model(res_lc2016_male_total_incomemod1,res_lc2016_male_gov_incomemod1,res_lc2016_male_work_incomemod1,
                                            dv.labels = c("total_male","gov_male", "work_male"),
                      string.pred = "Coeffcient",
                      string.ci = "Conf. Int (95%)",
                      string.p = "P-Value", 
                      linebreak = TRUE,
                      digits = 3, digits.p = 2,
                      title = "crude screening rate (lc, 2016, income-kokko_quake), data = 2016",
                      file = "C:\\Users\\megme\\Documents\\cleaning variables\\lc2016data2016_male_incomemod1.html" )
lc2016data2016_male_incomemod1
```

    


# lc female ----
cscr_totallc_2016 + cscr_totallc_mod_2016 + cscr_govlc_2016 + cscr_govlc_mod_2016 +
cscr_worklc_2016 +    cscr_worklc_mod_2016 +cscr_otherlc_2016 + cscr_otherlc_mod_2016 +


incomediffexpenceperpop_milyen_mod1 + incomediffexpenceperpop_milyen_mod1*haslimit_lc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_lc +  forfree_lc +   
othercity_lc +  offhours_lc + asmrlc2018
 
```{r lm cscrlc_total female}

res_lc2016_female_total_incomemod1 <- lm(data = lc2016_incomemod, cscr_totallc_2016 ~ 
                                          incomediffexpenceperpop_milyen_mod1 + incomediffexpenceperpop_milyen_mod1*haslimit_lc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_lc +  forfree_lc +   
othercity_lc +  offhours_lc + asmrlc2018

,subset =  sex == "female")
summary(res_lc2016_female_total_incomemod1)
vif(res_lc2016_female_total_incomemod1)
step(res_lc2016_female_total_incomemod1)
```




```{r cscrlc_gov female}


res_lc2016_female_gov_incomemod1 <- lm(data = lc2016_incomemod, cscr_govlc_2016 ~ 
                                        incomediffexpenceperpop_milyen_mod1 + incomediffexpenceperpop_milyen_mod1*haslimit_lc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_lc +  forfree_lc +   
othercity_lc +  offhours_lc + asmrlc2018
, subset =  sex == "female")
summary(res_lc2016_female_gov_incomemod1)

vif(res_lc2016_female_gov_incomemod1)
step(res_lc2016_female_gov_incomemod1)


```

```{r cscrlc_work female}


res_lc2016_female_work_incomemod1 <- lm(data = lc2016_incomemod, cscr_worklc_2016 ~  
                                       incomediffexpenceperpop_milyen_mod1 + incomediffexpenceperpop_milyen_mod1*haslimit_lc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_lc +  forfree_lc +   
othercity_lc +  offhours_lc + asmrlc2018
, subset =  sex == "female")
summary(res_lc2016_female_work_incomemod1)
vif(res_lc2016_female_work_incomemod1)
step(res_lc2016_female_work_incomemod1)

```



```{r}
lc2016data2016_female_incomemod1 <- tab_model(res_lc2016_female_total_incomemod1,res_lc2016_female_gov_incomemod1,res_lc2016_female_work_incomemod1,
                                              dv.labels = c("total_female","gov_female", "work_female"),
                      string.pred = "Coeffcient",
                      string.ci = "Conf. Int (95%)",
                      string.p = "P-Value", 
                      linebreak = TRUE,
                      digits = 3, digits.p = 2,
                      title = "crude screening rate (lc, 2016, income-kokko_quake), data = 2016",
                      file = "C:\\Users\\megme\\Documents\\cleaning variables\\lc2016data2016_female_incomemod1.html" )
lc2016data2016_female_incomemod1
```
# crc male ----
cscr_totalcrc_2016 + cscr_totalcrc_mod_2016 + cscr_govcrc_2016 + cscr_govcrc_mod_2016 +
cscr_workcrc_2016 +    cscr_workcrc_mod_2016 +cscr_othercrc_2016 + cscr_othercrc_mod_2016 +


 incomediffexpenceperpop_milyen_mod1 + incomediffexpenceperpop_milyen_mod1*haslimit_crc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_crc +  forfree_crc +   
othercity_crc +  offhours_crc + asmrcrc2018


```{r lm cscrcrc_total male}

res_crc2016_male_total_incomemod1 <- lm(data = crc2016_incomemod, cscr_totalcrc_2016 ~ 
                              incomediffexpenceperpop_milyen_mod1 + incomediffexpenceperpop_milyen_mod1*haslimit_crc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_crc +  forfree_crc +   
othercity_crc +  offhours_crc + asmrcrc2018
,subset =  sex == "male")
summary(res_crc2016_male_total_incomemod1)
vif(res_crc2016_male_total_incomemod1)
step(res_crc2016_male_total_incomemod1)

```




```{r cscrcrc_gov male}


res_crc2016_male_gov_incomemod1 <- lm(data = crc2016_incomemod, cscr_govcrc_2016 ~  
                              incomediffexpenceperpop_milyen_mod1 + incomediffexpenceperpop_milyen_mod1*haslimit_crc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_crc +  forfree_crc +   
othercity_crc +  offhours_crc + asmrcrc2018
, subset =  sex == "male")
summary(res_crc2016_male_gov_incomemod1)
vif(res_crc2016_male_gov_incomemod1)
step(res_crc2016_male_gov_incomemod1)


```

```{r cscrcrc_work male}


res_crc2016_male_work_incomemod1 <- lm(data = crc2016_incomemod, cscr_workcrc_2016 ~ 
                                        incomediffexpenceperpop_milyen_mod1 + incomediffexpenceperpop_milyen_mod1*haslimit_crc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_crc +  forfree_crc +   
othercity_crc +  offhours_crc + asmrcrc2018
, subset =  sex == "male")
summary(res_crc2016_male_work_incomemod1)
vif(res_crc2016_male_work_incomemod1)
step(res_crc2016_male_work_incomemod1)

```



```{r}
crc2016data2016_male_incomemod1 <- tab_model(res_crc2016_male_total_incomemod1,res_crc2016_male_gov_incomemod1,res_crc2016_male_work_incomemod1,
                                             dv.labels = c("total_male","gov_male", "work_male"),
                      string.pred = "Coeffcient",
                      string.ci = "Conf. Int (95%)",
                      string.p = "P-Value", 
                      linebreak = TRUE,
                      digits = 3, digits.p = 2,
                      title = "crude screening rate (crc, 2016, income-kokko_quake), data = 2016",
                      file = "C:\\Users\\megme\\Documents\\cleaning variables\\crc2016data2016_male_incomemod1.html" )
crc2016data2016_male_incomemod1
```

    


# crc female ----
cscr_totalcrc_2016 + cscr_totalcrc_mod_2016 + cscr_govcrc_2016 + cscr_govcrc_mod_2016 +
cscr_workcrc_2016 +    cscr_workcrc_mod_2016 +cscr_othercrc_2016 + cscr_othercrc_mod_2016 +


incomediffexpenceperpop_milyen_mod1 + incomediffexpenceperpop_milyen_mod1*haslimit_crc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_crc +  forfree_crc +   
othercity_crc +  offhours_crc + asmrcrc2018
 
```{r lm cscrcrc_total female}

res_crc2016_female_total_incomemod1 <- lm(data = crc2016_incomemod, cscr_totalcrc_2016 ~ 
                                          incomediffexpenceperpop_milyen_mod1 + incomediffexpenceperpop_milyen_mod1*haslimit_crc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_crc +  forfree_crc +   
othercity_crc +  offhours_crc + asmrcrc2018

,subset =  sex == "female")
summary(res_crc2016_female_total_incomemod1)
vif(res_crc2016_female_total_incomemod1)
step(res_crc2016_female_total_incomemod1)
```




```{r cscrcrc_gov female}


res_crc2016_female_gov_incomemod1 <- lm(data = crc2016_incomemod, cscr_govcrc_2016 ~ 
                                        incomediffexpenceperpop_milyen_mod1 + incomediffexpenceperpop_milyen_mod1*haslimit_crc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_crc +  forfree_crc +   
othercity_crc +  offhours_crc + asmrcrc2018
, subset =  sex == "female")
summary(res_crc2016_female_gov_incomemod1)

vif(res_crc2016_female_gov_incomemod1)
step(res_crc2016_female_gov_incomemod1)


```

```{r cscrcrc_work female}


res_crc2016_female_work_incomemod1 <- lm(data = crc2016_incomemod, cscr_workcrc_2016 ~  
                                       incomediffexpenceperpop_milyen_mod1 + incomediffexpenceperpop_milyen_mod1*haslimit_crc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_crc +  forfree_crc +   
othercity_crc +  offhours_crc + asmrcrc2018
, subset =  sex == "female")
summary(res_crc2016_female_work_incomemod1)
vif(res_crc2016_female_work_incomemod1)
step(res_crc2016_female_work_incomemod1)

```



```{r}
crc2016data2016_female_incomemod1 <- tab_model(res_crc2016_female_total_incomemod1,res_crc2016_female_gov_incomemod1,res_crc2016_female_work_incomemod1,
                                               dv.labels = c("total_female","gov_female", "work_female"),
                      string.pred = "Coeffcient",
                      string.ci = "Conf. Int (95%)",
                      string.p = "P-Value", 
                      linebreak = TRUE,
                      digits = 3, digits.p = 2,
                      title = "crude screening rate (crc, 2016, income-kokko_quake), data = 2016",
                      file = "C:\\Users\\megme\\Documents\\cleaning variables\\crc2016data2016_female_incomemod1.html" )
crc2016data2016_female_incomemod1
```


# bc female ----
cscr_totalbc_2016 + cscr_totalbc_mod_2016 + cscr_govbc_2016 + cscr_govbc_mod_2016 +
cscr_workbc_2016 +    cscr_workbc_mod_2016 +cscr_otherbc_2016 + cscr_otherbc_mod_2016 +


incomediffexpenceperpop_milyen_mod1 + incomediffexpenceperpop_milyen_mod1*haslimit_bc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_bc +  forfree_bc +   
othercity_bc +  offhours_bc + asmrbc2018
 
```{r lm cscrbc_total female}

res_bc2016_female_total_incomemod1 <- lm(data = bc2016_incomemod, cscr_totalbc_2016 ~ 
                                          incomediffexpenceperpop_milyen_mod1 + incomediffexpenceperpop_milyen_mod1*haslimit_bc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_bc +  forfree_bc +   
othercity_bc +  offhours_bc + asmrbc2018

,subset =  sex == "female")
summary(res_bc2016_female_total_incomemod1)
vif(res_bc2016_female_total_incomemod1)
step(res_bc2016_female_total_incomemod1)
```




```{r cscrbc_gov female}


res_bc2016_female_gov_incomemod1 <- lm(data = bc2016_incomemod, cscr_govbc_2016 ~ 
                                        incomediffexpenceperpop_milyen_mod1 + incomediffexpenceperpop_milyen_mod1*haslimit_bc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_bc +  forfree_bc +   
othercity_bc +  offhours_bc + asmrbc2018
, subset =  sex == "female")
summary(res_bc2016_female_gov_incomemod1)

vif(res_bc2016_female_gov_incomemod1)
step(res_bc2016_female_gov_incomemod1)


```

```{r cscrbc_work female}


res_bc2016_female_work_incomemod1 <- lm(data = bc2016_incomemod, cscr_workbc_2016 ~  
                                       incomediffexpenceperpop_milyen_mod1 + incomediffexpenceperpop_milyen_mod1*haslimit_bc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_bc +  forfree_bc +   
othercity_bc +  offhours_bc + asmrbc2018
, subset =  sex == "female")
summary(res_bc2016_female_work_incomemod1)
vif(res_bc2016_female_work_incomemod1)
step(res_bc2016_female_work_incomemod1)

```



```{r}
bc2016data2016_female_incomemod1 <- tab_model(res_bc2016_female_total_incomemod1,res_bc2016_female_gov_incomemod1,res_bc2016_female_work_incomemod1,
                                              dv.labels = c("total_female","gov_female", "work_female"),
                      string.pred = "Coeffcient",
                      string.ci = "Conf. Int (95%)",
                      string.p = "P-Value", 
                      linebreak = TRUE,
                      digits = 3, digits.p = 2,
                      title = "crude screening rate (bc, 2016, income-kokko_quake), data = 2016",
                      file = "C:\\Users\\megme\\Documents\\cleaning variables\\bc2016data2016_female_incomemod1.html" )
bc2016data2016_female_incomemod1
```






#up20s----

```{r setting dataset}
merge1_incomemod <- merge(mergecscr_h28_up20, merged_variables4, by = c("pref","sex"), all = T) %>% 
  select(year,pref,sex, everything() )
names(merge1_incomemod)[5:44] %>% 
  paste0(., "_2016") ->names(merge1_incomemod)[5:44]

merge1_incomemod %>% 
  select( -contains("_lc"), -contains("lc_"),
          -contains("_crc"), -contains("crc_"),
          -contains("_gc"), -contains("gc_"),
          -contains("_bc"), -contains("bc_")) ->merge1_incomemod_cvc


merge1_incomemod_cvc %>% 
  filter(pref != "熊本") %>% 
  filter(year == "2016") -> cvc2016_incomemod

```

# cvc female ----
cscr_totalcvc_2016 + cscr_totalcvc_mod_2016 + cscr_govcvc_2016 + cscr_govcvc_mod_2016 +
cscr_workcvc_2016 +    cscr_workcvc_mod_2016 +cscr_othercvc_2016 + cscr_othercvc_mod_2016 +


incomediffexpenceperpop_milyen_mod1 + incomediffexpenceperpop_milyen_mod1*haslimit_cvc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_cvc +  forfree_cvc +   
othercity_cvc +  offhours_cvc + asmrcvc2018
 
```{r lm cscrcvc_total female}

res_cvc2016_female_total_incomemod1 <- lm(data = cvc2016_incomemod, cscr_totalcvc_2016 ~ 
                                          incomediffexpenceperpop_milyen_mod1 + incomediffexpenceperpop_milyen_mod1*haslimit_cvc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_cvc +  forfree_cvc +   
othercity_cvc +  offhours_cvc + asmrcvc2018

,subset =  sex == "female")
summary(res_cvc2016_female_total_incomemod1)
vif(res_cvc2016_female_total_incomemod1)
step(res_cvc2016_female_total_incomemod1)
```




```{r cscrcvc_gov female}


res_cvc2016_female_gov_incomemod1 <- lm(data = cvc2016_incomemod, cscr_govcvc_2016 ~ 
                                        incomediffexpenceperpop_milyen_mod1 + incomediffexpenceperpop_milyen_mod1*haslimit_cvc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_cvc +  forfree_cvc +   
othercity_cvc +  offhours_cvc + asmrcvc2018
, subset =  sex == "female")
summary(res_cvc2016_female_gov_incomemod1)

vif(res_cvc2016_female_gov_incomemod1)
step(res_cvc2016_female_gov_incomemod1)


```

```{r cscrcvc_work female}


res_cvc2016_female_work_incomemod1 <- lm(data = cvc2016_incomemod, cscr_workcvc_2016 ~  
                                       incomediffexpenceperpop_milyen_mod1 + incomediffexpenceperpop_milyen_mod1*haslimit_cvc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_cvc +  forfree_cvc +   
othercity_cvc +  offhours_cvc + asmrcvc2018
, subset =  sex == "female")
summary(res_cvc2016_female_work_incomemod1)
vif(res_cvc2016_female_work_incomemod1)
step(res_cvc2016_female_work_incomemod1)

```



```{r}
cvc2016data2016_female_incomemod1 <- tab_model(res_cvc2016_female_total_incomemod1,res_cvc2016_female_gov_incomemod1,res_cvc2016_female_work_incomemod1,
                                               dv.labels = c("total_female","gov_female", "work_female"),
                      string.pred = "Coeffcient",
                      string.ci = "Conf. Int (95%)",
                      string.p = "P-Value", 
                      linebreak = TRUE,
                      digits = 3, digits.p = 2,
                      title = "crude screening rate (cvc, 2016, income-kokko_quake), data = 2016",
                      file = "C:\\Users\\megme\\Documents\\cleaning variables\\cvc2016data2016_female_incomemod1.html" )
cvc2016data2016_female_incomemod1
```





# mod2 ----

# gc male ----
cscr_totalgc_2016 + cscr_totalgc_mod_2016 + cscr_govgc_2016 + cscr_govgc_mod_2016 +
cscr_workgc_2016 +    cscr_workgc_mod_2016 +cscr_othergc_2016 + cscr_othergc_mod_2016 +


 incomediffexpenceperpop_milyen_mod2 + incomediffexpenceperpop_milyen_mod2*haslimit_gc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_gc +  forfree_gc +   
othercity_gc +  offhours_gc + asmrgc2018


```{r lm cscrgc_total male}

res_gc2016_male_total_incomemod2 <- lm(data = gc2016_incomemod, cscr_totalgc_2016 ~ 
                              incomediffexpenceperpop_milyen_mod2 + incomediffexpenceperpop_milyen_mod2*haslimit_gc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_gc +  forfree_gc +   
othercity_gc +  offhours_gc + asmrgc2018
,subset =  sex == "male")
summary(res_gc2016_male_total_incomemod2)
vif(res_gc2016_male_total_incomemod2)
step(res_gc2016_male_total_incomemod2)

```




```{r cscrgc_gov male}


res_gc2016_male_gov_incomemod2 <- lm(data = gc2016_incomemod, cscr_govgc_2016 ~  
                              incomediffexpenceperpop_milyen_mod2 + incomediffexpenceperpop_milyen_mod2*haslimit_gc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_gc +  forfree_gc +   
othercity_gc +  offhours_gc + asmrgc2018
, subset =  sex == "male")
summary(res_gc2016_male_gov_incomemod2)
vif(res_gc2016_male_gov_incomemod2)
step(res_gc2016_male_gov_incomemod2)


```

```{r cscrgc_work male}


res_gc2016_male_work_incomemod2 <- lm(data = gc2016_incomemod, cscr_workgc_2016 ~ 
                                        incomediffexpenceperpop_milyen_mod2 + incomediffexpenceperpop_milyen_mod2*haslimit_gc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_gc +  forfree_gc +   
othercity_gc +  offhours_gc + asmrgc2018
, subset =  sex == "male")
summary(res_gc2016_male_work_incomemod2)
vif(res_gc2016_male_work_incomemod2)
step(res_gc2016_male_work_incomemod2)

```



```{r}
gc2016data2016_male_incomemod2 <- tab_model(res_gc2016_male_total_incomemod2,res_gc2016_male_gov_incomemod2,res_gc2016_male_work_incomemod2,
                                            dv.labels = c("total_male","gov_male", "work_male"),
                      string.pred = "Coeffcient",
                      string.ci = "Conf. Int (95%)",
                      string.p = "P-Value", 
                      linebreak = TRUE,
                      digits = 3, digits.p = 2,
                      title = "crude screening rate (GC, 2016, income-kokko_quake), data = 2016",
                      file = "C:\\Users\\megme\\Documents\\cleaning variables\\gc2016data2016_male_incomemod2.html" )
gc2016data2016_male_incomemod2
```

    


# gc female ----
cscr_totalgc_2016 + cscr_totalgc_mod_2016 + cscr_govgc_2016 + cscr_govgc_mod_2016 +
cscr_workgc_2016 +    cscr_workgc_mod_2016 +cscr_othergc_2016 + cscr_othergc_mod_2016 +


incomediffexpenceperpop_milyen_mod2 + incomediffexpenceperpop_milyen_mod2*haslimit_gc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_gc +  forfree_gc +   
othercity_gc +  offhours_gc + asmrgc2018
 
```{r lm cscrgc_total female}

res_gc2016_female_total_incomemod2 <- lm(data = gc2016_incomemod, cscr_totalgc_2016 ~ 
                                          incomediffexpenceperpop_milyen_mod2 + incomediffexpenceperpop_milyen_mod2*haslimit_gc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_gc +  forfree_gc +   
othercity_gc +  offhours_gc + asmrgc2018

,subset =  sex == "female")
summary(res_gc2016_female_total_incomemod2)
vif(res_gc2016_female_total_incomemod2)
step(res_gc2016_female_total_incomemod2)
```




```{r cscrgc_gov female}


res_gc2016_female_gov_incomemod2 <- lm(data = gc2016_incomemod, cscr_govgc_2016 ~ 
                                        incomediffexpenceperpop_milyen_mod2 + incomediffexpenceperpop_milyen_mod2*haslimit_gc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_gc +  forfree_gc +   
othercity_gc +  offhours_gc + asmrgc2018
, subset =  sex == "female")
summary(res_gc2016_female_gov_incomemod2)

vif(res_gc2016_female_gov_incomemod2)
step(res_gc2016_female_gov_incomemod2)


```

```{r cscrgc_work female}


res_gc2016_female_work_incomemod2 <- lm(data = gc2016_incomemod, cscr_workgc_2016 ~  
                                       incomediffexpenceperpop_milyen_mod2 + incomediffexpenceperpop_milyen_mod2*haslimit_gc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_gc +  forfree_gc +   
othercity_gc +  offhours_gc + asmrgc2018
, subset =  sex == "female")
summary(res_gc2016_female_work_incomemod2)
vif(res_gc2016_female_work_incomemod2)
step(res_gc2016_female_work_incomemod2)

```



```{r}
gc2016data2016_female_incomemod2 <- tab_model(res_gc2016_female_total_incomemod2,res_gc2016_female_gov_incomemod2,res_gc2016_female_work_incomemod2,
                                              dv.labels = c("total_female","gov_female", "work_female"),
                      string.pred = "Coeffcient",
                      string.ci = "Conf. Int (95%)",
                      string.p = "P-Value", 
                      linebreak = TRUE,
                      digits = 3, digits.p = 2,
                      title = "crude screening rate (GC, 2016, income-kokko_quake), data = 2016",
                      file = "C:\\Users\\megme\\Documents\\cleaning variables\\gc2016data2016_female_incomemod2.html" )
gc2016data2016_female_incomemod2
```



# lc male ----
cscr_totallc_2016 + cscr_totallc_mod_2016 + cscr_govlc_2016 + cscr_govlc_mod_2016 +
cscr_worklc_2016 +    cscr_worklc_mod_2016 +cscr_otherlc_2016 + cscr_otherlc_mod_2016 +


 incomediffexpenceperpop_milyen_mod2 + incomediffexpenceperpop_milyen_mod2*haslimit_lc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_lc +  forfree_lc +   
othercity_lc +  offhours_lc + asmrlc2018


```{r lm cscrlc_total male}

res_lc2016_male_total_incomemod2 <- lm(data = lc2016_incomemod, cscr_totallc_2016 ~ 
                              incomediffexpenceperpop_milyen_mod2 + incomediffexpenceperpop_milyen_mod2*haslimit_lc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_lc +  forfree_lc +   
othercity_lc +  offhours_lc + asmrlc2018
,subset =  sex == "male")
summary(res_lc2016_male_total_incomemod2)
vif(res_lc2016_male_total_incomemod2)
step(res_lc2016_male_total_incomemod2)

```




```{r cscrlc_gov male}


res_lc2016_male_gov_incomemod2 <- lm(data = lc2016_incomemod, cscr_govlc_2016 ~  
                              incomediffexpenceperpop_milyen_mod2 + incomediffexpenceperpop_milyen_mod2*haslimit_lc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_lc +  forfree_lc +   
othercity_lc +  offhours_lc + asmrlc2018
, subset =  sex == "male")
summary(res_lc2016_male_gov_incomemod2)
vif(res_lc2016_male_gov_incomemod2)
step(res_lc2016_male_gov_incomemod2)


```

```{r cscrlc_work male}


res_lc2016_male_work_incomemod2 <- lm(data = lc2016_incomemod, cscr_worklc_2016 ~ 
                                        incomediffexpenceperpop_milyen_mod2 + incomediffexpenceperpop_milyen_mod2*haslimit_lc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_lc +  forfree_lc +   
othercity_lc +  offhours_lc + asmrlc2018
, subset =  sex == "male")
summary(res_lc2016_male_work_incomemod2)
vif(res_lc2016_male_work_incomemod2)
step(res_lc2016_male_work_incomemod2)

```



```{r}
lc2016data2016_male_incomemod2 <- tab_model(res_lc2016_male_total_incomemod2,res_lc2016_male_gov_incomemod2,res_lc2016_male_work_incomemod2,
                                            dv.labels = c("total_male","gov_male", "work_male"),
                      string.pred = "Coeffcient",
                      string.ci = "Conf. Int (95%)",
                      string.p = "P-Value", 
                      linebreak = TRUE,
                      digits = 3, digits.p = 2,
                      title = "crude screening rate (lc, 2016, income-kokko_quake), data = 2016",
                      file = "C:\\Users\\megme\\Documents\\cleaning variables\\lc2016data2016_male_incomemod2.html" )
lc2016data2016_male_incomemod2
```

    


# lc female ----
cscr_totallc_2016 + cscr_totallc_mod_2016 + cscr_govlc_2016 + cscr_govlc_mod_2016 +
cscr_worklc_2016 +    cscr_worklc_mod_2016 +cscr_otherlc_2016 + cscr_otherlc_mod_2016 +


incomediffexpenceperpop_milyen_mod2 + incomediffexpenceperpop_milyen_mod2*haslimit_lc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_lc +  forfree_lc +   
othercity_lc +  offhours_lc + asmrlc2018
 
```{r lm cscrlc_total female}

res_lc2016_female_total_incomemod2 <- lm(data = lc2016_incomemod, cscr_totallc_2016 ~ 
                                          incomediffexpenceperpop_milyen_mod2 + incomediffexpenceperpop_milyen_mod2*haslimit_lc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_lc +  forfree_lc +   
othercity_lc +  offhours_lc + asmrlc2018

,subset =  sex == "female")
summary(res_lc2016_female_total_incomemod2)
vif(res_lc2016_female_total_incomemod2)
step(res_lc2016_female_total_incomemod2)
```




```{r cscrlc_gov female}


res_lc2016_female_gov_incomemod2 <- lm(data = lc2016_incomemod, cscr_govlc_2016 ~ 
                                        incomediffexpenceperpop_milyen_mod2 + incomediffexpenceperpop_milyen_mod2*haslimit_lc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_lc +  forfree_lc +   
othercity_lc +  offhours_lc + asmrlc2018
, subset =  sex == "female")
summary(res_lc2016_female_gov_incomemod2)

vif(res_lc2016_female_gov_incomemod2)
step(res_lc2016_female_gov_incomemod2)


```

```{r cscrlc_work female}


res_lc2016_female_work_incomemod2 <- lm(data = lc2016_incomemod, cscr_worklc_2016 ~  
                                       incomediffexpenceperpop_milyen_mod2 + incomediffexpenceperpop_milyen_mod2*haslimit_lc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_lc +  forfree_lc +   
othercity_lc +  offhours_lc + asmrlc2018
, subset =  sex == "female")
summary(res_lc2016_female_work_incomemod2)
vif(res_lc2016_female_work_incomemod2)
step(res_lc2016_female_work_incomemod2)

```



```{r}
lc2016data2016_female_incomemod2 <- tab_model(res_lc2016_female_total_incomemod2,res_lc2016_female_gov_incomemod2,res_lc2016_female_work_incomemod2,
                                              dv.labels = c("total_female","gov_female", "work_female"),
                      string.pred = "Coeffcient",
                      string.ci = "Conf. Int (95%)",
                      string.p = "P-Value", 
                      linebreak = TRUE,
                      digits = 3, digits.p = 2,
                      title = "crude screening rate (lc, 2016, income-kokko_quake), data = 2016",
                      file = "C:\\Users\\megme\\Documents\\cleaning variables\\lc2016data2016_female_incomemod2.html" )
lc2016data2016_female_incomemod2
```
# crc male ----
cscr_totalcrc_2016 + cscr_totalcrc_mod_2016 + cscr_govcrc_2016 + cscr_govcrc_mod_2016 +
cscr_workcrc_2016 +    cscr_workcrc_mod_2016 +cscr_othercrc_2016 + cscr_othercrc_mod_2016 +


 incomediffexpenceperpop_milyen_mod2 + incomediffexpenceperpop_milyen_mod2*haslimit_crc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_crc +  forfree_crc +   
othercity_crc +  offhours_crc + asmrcrc2018


```{r lm cscrcrc_total male}

res_crc2016_male_total_incomemod2 <- lm(data = crc2016_incomemod, cscr_totalcrc_2016 ~ 
                              incomediffexpenceperpop_milyen_mod2 + incomediffexpenceperpop_milyen_mod2*haslimit_crc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_crc +  forfree_crc +   
othercity_crc +  offhours_crc + asmrcrc2018
,subset =  sex == "male")
summary(res_crc2016_male_total_incomemod2)
vif(res_crc2016_male_total_incomemod2)
step(res_crc2016_male_total_incomemod2)

```




```{r cscrcrc_gov male}


res_crc2016_male_gov_incomemod2 <- lm(data = crc2016_incomemod, cscr_govcrc_2016 ~  
                              incomediffexpenceperpop_milyen_mod2 + incomediffexpenceperpop_milyen_mod2*haslimit_crc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_crc +  forfree_crc +   
othercity_crc +  offhours_crc + asmrcrc2018
, subset =  sex == "male")
summary(res_crc2016_male_gov_incomemod2)
vif(res_crc2016_male_gov_incomemod2)
step(res_crc2016_male_gov_incomemod2)


```

```{r cscrcrc_work male}


res_crc2016_male_work_incomemod2 <- lm(data = crc2016_incomemod, cscr_workcrc_2016 ~ 
                                        incomediffexpenceperpop_milyen_mod2 + incomediffexpenceperpop_milyen_mod2*haslimit_crc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_crc +  forfree_crc +   
othercity_crc +  offhours_crc + asmrcrc2018
, subset =  sex == "male")
summary(res_crc2016_male_work_incomemod2)
vif(res_crc2016_male_work_incomemod2)
step(res_crc2016_male_work_incomemod2)

```



```{r}
crc2016data2016_male_incomemod2 <- tab_model(res_crc2016_male_total_incomemod2,res_crc2016_male_gov_incomemod2,res_crc2016_male_work_incomemod2,
                                             dv.labels = c("total_male","gov_male", "work_male"),
                      string.pred = "Coeffcient",
                      string.ci = "Conf. Int (95%)",
                      string.p = "P-Value", 
                      linebreak = TRUE,
                      digits = 3, digits.p = 2,
                      title = "crude screening rate (crc, 2016, income-kokko_quake), data = 2016",
                      file = "C:\\Users\\megme\\Documents\\cleaning variables\\crc2016data2016_male_incomemod2.html" )
crc2016data2016_male_incomemod2
```

    


# crc female ----
cscr_totalcrc_2016 + cscr_totalcrc_mod_2016 + cscr_govcrc_2016 + cscr_govcrc_mod_2016 +
cscr_workcrc_2016 +    cscr_workcrc_mod_2016 +cscr_othercrc_2016 + cscr_othercrc_mod_2016 +


incomediffexpenceperpop_milyen_mod2 + incomediffexpenceperpop_milyen_mod2*haslimit_crc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_crc +  forfree_crc +   
othercity_crc +  offhours_crc + asmrcrc2018
 
```{r lm cscrcrc_total female}

res_crc2016_female_total_incomemod2 <- lm(data = crc2016_incomemod, cscr_totalcrc_2016 ~ 
                                          incomediffexpenceperpop_milyen_mod2 + incomediffexpenceperpop_milyen_mod2*haslimit_crc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_crc +  forfree_crc +   
othercity_crc +  offhours_crc + asmrcrc2018

,subset =  sex == "female")
summary(res_crc2016_female_total_incomemod2)
vif(res_crc2016_female_total_incomemod2)
step(res_crc2016_female_total_incomemod2)
```




```{r cscrcrc_gov female}


res_crc2016_female_gov_incomemod2 <- lm(data = crc2016_incomemod, cscr_govcrc_2016 ~ 
                                        incomediffexpenceperpop_milyen_mod2 + incomediffexpenceperpop_milyen_mod2*haslimit_crc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_crc +  forfree_crc +   
othercity_crc +  offhours_crc + asmrcrc2018
, subset =  sex == "female")
summary(res_crc2016_female_gov_incomemod2)

vif(res_crc2016_female_gov_incomemod2)
step(res_crc2016_female_gov_incomemod2)


```

```{r cscrcrc_work female}


res_crc2016_female_work_incomemod2 <- lm(data = crc2016_incomemod, cscr_workcrc_2016 ~  
                                       incomediffexpenceperpop_milyen_mod2 + incomediffexpenceperpop_milyen_mod2*haslimit_crc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_crc +  forfree_crc +   
othercity_crc +  offhours_crc + asmrcrc2018
, subset =  sex == "female")
summary(res_crc2016_female_work_incomemod2)
vif(res_crc2016_female_work_incomemod2)
step(res_crc2016_female_work_incomemod2)

```



```{r}
crc2016data2016_female_incomemod2 <- tab_model(res_crc2016_female_total_incomemod2,res_crc2016_female_gov_incomemod2,res_crc2016_female_work_incomemod2,
                                               dv.labels = c("total_female","gov_female", "work_female"),
                      string.pred = "Coeffcient",
                      string.ci = "Conf. Int (95%)",
                      string.p = "P-Value", 
                      linebreak = TRUE,
                      digits = 3, digits.p = 2,
                      title = "crude screening rate (crc, 2016, income-kokko_quake), data = 2016",
                      file = "C:\\Users\\megme\\Documents\\cleaning variables\\crc2016data2016_female_incomemod2.html" )
crc2016data2016_female_incomemod2
```


# bc female ----
cscr_totalbc_2016 + cscr_totalbc_mod_2016 + cscr_govbc_2016 + cscr_govbc_mod_2016 +
cscr_workbc_2016 +    cscr_workbc_mod_2016 +cscr_otherbc_2016 + cscr_otherbc_mod_2016 +


incomediffexpenceperpop_milyen_mod2 + incomediffexpenceperpop_milyen_mod2*haslimit_bc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_bc +  forfree_bc +   
othercity_bc +  offhours_bc + asmrbc2018
 
```{r lm cscrbc_total female}

res_bc2016_female_total_incomemod2 <- lm(data = bc2016_incomemod, cscr_totalbc_2016 ~ 
                                          incomediffexpenceperpop_milyen_mod2 + incomediffexpenceperpop_milyen_mod2*haslimit_bc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_bc +  forfree_bc +   
othercity_bc +  offhours_bc + asmrbc2018

,subset =  sex == "female")
summary(res_bc2016_female_total_incomemod2)
vif(res_bc2016_female_total_incomemod2)
step(res_bc2016_female_total_incomemod2)
```




```{r cscrbc_gov female}


res_bc2016_female_gov_incomemod2 <- lm(data = bc2016_incomemod, cscr_govbc_2016 ~ 
                                        incomediffexpenceperpop_milyen_mod2 + incomediffexpenceperpop_milyen_mod2*haslimit_bc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_bc +  forfree_bc +   
othercity_bc +  offhours_bc + asmrbc2018
, subset =  sex == "female")
summary(res_bc2016_female_gov_incomemod2)

vif(res_bc2016_female_gov_incomemod2)
step(res_bc2016_female_gov_incomemod2)


```

```{r cscrbc_work female}


res_bc2016_female_work_incomemod2 <- lm(data = bc2016_incomemod, cscr_workbc_2016 ~  
                                       incomediffexpenceperpop_milyen_mod2 + incomediffexpenceperpop_milyen_mod2*haslimit_bc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_bc +  forfree_bc +   
othercity_bc +  offhours_bc + asmrbc2018
, subset =  sex == "female")
summary(res_bc2016_female_work_incomemod2)
vif(res_bc2016_female_work_incomemod2)
step(res_bc2016_female_work_incomemod2)

```



```{r}
bc2016data2016_female_incomemod2 <- tab_model(res_bc2016_female_total_incomemod2,res_bc2016_female_gov_incomemod2,res_bc2016_female_work_incomemod2,
                                              dv.labels = c("total_female","gov_female", "work_female"),
                      string.pred = "Coeffcient",
                      string.ci = "Conf. Int (95%)",
                      string.p = "P-Value", 
                      linebreak = TRUE,
                      digits = 3, digits.p = 2,
                      title = "crude screening rate (bc, 2016, income-kokko_quake), data = 2016",
                      file = "C:\\Users\\megme\\Documents\\cleaning variables\\bc2016data2016_female_incomemod2.html" )
bc2016data2016_female_incomemod2
```






#up20s----

```{r setting dataset}
merge1_incomemod <- merge(mergecscr_h28_up20, merged_variables4, by = c("pref","sex"), all = T) %>% 
  select(year,pref,sex, everything() )
names(merge1_incomemod)[5:44] %>% 
  paste0(., "_2016") ->names(merge1_incomemod)[5:44]


merge1_incomemod %>% 
  select( -contains("_lc"), -contains("lc_"),
          -contains("_crc"), -contains("crc_"),
          -contains("_gc"), -contains("gc_"),
          -contains("_bc"), -contains("bc_")) ->merge1_incomemod_cvc

merge1_incomemod_cvc %>% 
  filter(pref != "熊本") %>% 
  filter(year == "2016") -> cvc2016_incomemod

```

# cvc female ----
cscr_totalcvc_2016 + cscr_totalcvc_mod_2016 + cscr_govcvc_2016 + cscr_govcvc_mod_2016 +
cscr_workcvc_2016 +    cscr_workcvc_mod_2016 +cscr_othercvc_2016 + cscr_othercvc_mod_2016 +


incomediffexpenceperpop_milyen_mod2 + incomediffexpenceperpop_milyen_mod2*haslimit_cvc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_cvc +  forfree_cvc +   
othercity_cvc +  offhours_cvc + asmrcvc2018
 
```{r lm cscrcvc_total female}

res_cvc2016_female_total_incomemod2 <- lm(data = cvc2016_incomemod, cscr_totalcvc_2016 ~ 
                                          incomediffexpenceperpop_milyen_mod2 + incomediffexpenceperpop_milyen_mod2*haslimit_cvc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_cvc +  forfree_cvc +   
othercity_cvc +  offhours_cvc + asmrcvc2018

,subset =  sex == "female")
summary(res_cvc2016_female_total_incomemod2)
vif(res_cvc2016_female_total_incomemod2)
step(res_cvc2016_female_total_incomemod2)
```




```{r cscrcvc_gov female}


res_cvc2016_female_gov_incomemod2 <- lm(data = cvc2016_incomemod, cscr_govcvc_2016 ~ 
                                        incomediffexpenceperpop_milyen_mod2 + incomediffexpenceperpop_milyen_mod2*haslimit_cvc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_cvc +  forfree_cvc +   
othercity_cvc +  offhours_cvc + asmrcvc2018
, subset =  sex == "female")
summary(res_cvc2016_female_gov_incomemod2)

vif(res_cvc2016_female_gov_incomemod2)
step(res_cvc2016_female_gov_incomemod2)


```

```{r cscrcvc_work female}


res_cvc2016_female_work_incomemod2 <- lm(data = cvc2016_incomemod, cscr_workcvc_2016 ~  
                                       incomediffexpenceperpop_milyen_mod2 + incomediffexpenceperpop_milyen_mod2*haslimit_cvc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_cvc +  forfree_cvc +   
othercity_cvc +  offhours_cvc + asmrcvc2018
, subset =  sex == "female")
summary(res_cvc2016_female_work_incomemod2)
vif(res_cvc2016_female_work_incomemod2)
step(res_cvc2016_female_work_incomemod2)

```



```{r}
cvc2016data2016_female_incomemod2 <- tab_model(res_cvc2016_female_total_incomemod2,res_cvc2016_female_gov_incomemod2,res_cvc2016_female_work_incomemod2,
                                               dv.labels = c("total_female","gov_female", "work_female"),
                      string.pred = "Coeffcient",
                      string.ci = "Conf. Int (95%)",
                      string.p = "P-Value", 
                      linebreak = TRUE,
                      digits = 3, digits.p = 2,
                      title = "crude screening rate (cvc, 2016, income-kokko_quake), data = 2016",
                      file = "C:\\Users\\megme\\Documents\\cleaning variables\\cvc2016data2016_female_incomemod2.html" )
cvc2016data2016_female_incomemod2
```





# mod3 ----

# gc male ----
cscr_totalgc_2016 + cscr_totalgc_mod_2016 + cscr_govgc_2016 + cscr_govgc_mod_2016 +
cscr_workgc_2016 +    cscr_workgc_mod_2016 +cscr_othergc_2016 + cscr_othergc_mod_2016 +


 incomediffexpenceperpop_milyen_mod3 + incomediffexpenceperpop_milyen_mod3*haslimit_gc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_gc +  forfree_gc +   
othercity_gc +  offhours_gc + asmrgc2018


```{r lm cscrgc_total male}

res_gc2016_male_total_incomemod3 <- lm(data = gc2016_incomemod, cscr_totalgc_2016 ~ 
                              incomediffexpenceperpop_milyen_mod3 + incomediffexpenceperpop_milyen_mod3*haslimit_gc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_gc +  forfree_gc +   
othercity_gc +  offhours_gc + asmrgc2018
,subset =  sex == "male")
summary(res_gc2016_male_total_incomemod3)
vif(res_gc2016_male_total_incomemod3)
step(res_gc2016_male_total_incomemod3)

```




```{r cscrgc_gov male}


res_gc2016_male_gov_incomemod3 <- lm(data = gc2016_incomemod, cscr_govgc_2016 ~  
                              incomediffexpenceperpop_milyen_mod3 + incomediffexpenceperpop_milyen_mod3*haslimit_gc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_gc +  forfree_gc +   
othercity_gc +  offhours_gc + asmrgc2018
, subset =  sex == "male")
summary(res_gc2016_male_gov_incomemod3)
vif(res_gc2016_male_gov_incomemod3)
step(res_gc2016_male_gov_incomemod3)


```

```{r cscrgc_work male}


res_gc2016_male_work_incomemod3 <- lm(data = gc2016_incomemod, cscr_workgc_2016 ~ 
                                        incomediffexpenceperpop_milyen_mod3 + incomediffexpenceperpop_milyen_mod3*haslimit_gc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_gc +  forfree_gc +   
othercity_gc +  offhours_gc + asmrgc2018
, subset =  sex == "male")
summary(res_gc2016_male_work_incomemod3)
vif(res_gc2016_male_work_incomemod3)
step(res_gc2016_male_work_incomemod3)

```



```{r}
gc2016data2016_male_incomemod3 <- tab_model(res_gc2016_male_total_incomemod3,res_gc2016_male_gov_incomemod3,res_gc2016_male_work_incomemod3,
                                            dv.labels = c("total_male","gov_male", "work_male"),
                      string.pred = "Coeffcient",
                      string.ci = "Conf. Int (95%)",
                      string.p = "P-Value", 
                      linebreak = TRUE,
                      digits = 3, digits.p = 2,
                      title = "crude screening rate (GC, 2016, income-kokko_quake), data = 2016",
                      file = "C:\\Users\\megme\\Documents\\cleaning variables\\gc2016data2016_male_incomemod3.html" )
gc2016data2016_male_incomemod3
```

    


# gc female ----
cscr_totalgc_2016 + cscr_totalgc_mod_2016 + cscr_govgc_2016 + cscr_govgc_mod_2016 +
cscr_workgc_2016 +    cscr_workgc_mod_2016 +cscr_othergc_2016 + cscr_othergc_mod_2016 +


incomediffexpenceperpop_milyen_mod3 + incomediffexpenceperpop_milyen_mod3*haslimit_gc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_gc +  forfree_gc +   
othercity_gc +  offhours_gc + asmrgc2018
 
```{r lm cscrgc_total female}

res_gc2016_female_total_incomemod3 <- lm(data = gc2016_incomemod, cscr_totalgc_2016 ~ 
                                          incomediffexpenceperpop_milyen_mod3 + incomediffexpenceperpop_milyen_mod3*haslimit_gc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_gc +  forfree_gc +   
othercity_gc +  offhours_gc + asmrgc2018

,subset =  sex == "female")
summary(res_gc2016_female_total_incomemod3)
vif(res_gc2016_female_total_incomemod3)
step(res_gc2016_female_total_incomemod3)
```




```{r cscrgc_gov female}


res_gc2016_female_gov_incomemod3 <- lm(data = gc2016_incomemod, cscr_govgc_2016 ~ 
                                        incomediffexpenceperpop_milyen_mod3 + incomediffexpenceperpop_milyen_mod3*haslimit_gc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_gc +  forfree_gc +   
othercity_gc +  offhours_gc + asmrgc2018
, subset =  sex == "female")
summary(res_gc2016_female_gov_incomemod3)

vif(res_gc2016_female_gov_incomemod3)
step(res_gc2016_female_gov_incomemod3)


```

```{r cscrgc_work female}


res_gc2016_female_work_incomemod3 <- lm(data = gc2016_incomemod, cscr_workgc_2016 ~  
                                       incomediffexpenceperpop_milyen_mod3 + incomediffexpenceperpop_milyen_mod3*haslimit_gc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_gc +  forfree_gc +   
othercity_gc +  offhours_gc + asmrgc2018
, subset =  sex == "female")
summary(res_gc2016_female_work_incomemod3)
vif(res_gc2016_female_work_incomemod3)
step(res_gc2016_female_work_incomemod3)

```



```{r}
gc2016data2016_female_incomemod3 <- tab_model(res_gc2016_female_total_incomemod3,res_gc2016_female_gov_incomemod3,res_gc2016_female_work_incomemod3,
                                              dv.labels = c("total_female","gov_female", "work_female"),
                      string.pred = "Coeffcient",
                      string.ci = "Conf. Int (95%)",
                      string.p = "P-Value", 
                      linebreak = TRUE,
                      digits = 3, digits.p = 2,
                      title = "crude screening rate (GC, 2016, income-kokko_quake), data = 2016",
                      file = "C:\\Users\\megme\\Documents\\cleaning variables\\gc2016data2016_female_incomemod3.html" )
gc2016data2016_female_incomemod3
```



# lc male ----
cscr_totallc_2016 + cscr_totallc_mod_2016 + cscr_govlc_2016 + cscr_govlc_mod_2016 +
cscr_worklc_2016 +    cscr_worklc_mod_2016 +cscr_otherlc_2016 + cscr_otherlc_mod_2016 +


 incomediffexpenceperpop_milyen_mod3 + incomediffexpenceperpop_milyen_mod3*haslimit_lc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_lc +  forfree_lc +   
othercity_lc +  offhours_lc + asmrlc2018


```{r lm cscrlc_total male}

res_lc2016_male_total_incomemod3 <- lm(data = lc2016_incomemod, cscr_totallc_2016 ~ 
                              incomediffexpenceperpop_milyen_mod3 + incomediffexpenceperpop_milyen_mod3*haslimit_lc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_lc +  forfree_lc +   
othercity_lc +  offhours_lc + asmrlc2018
,subset =  sex == "male")
summary(res_lc2016_male_total_incomemod3)
vif(res_lc2016_male_total_incomemod3)
step(res_lc2016_male_total_incomemod3)

```




```{r cscrlc_gov male}


res_lc2016_male_gov_incomemod3 <- lm(data = lc2016_incomemod, cscr_govlc_2016 ~  
                              incomediffexpenceperpop_milyen_mod3 + incomediffexpenceperpop_milyen_mod3*haslimit_lc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_lc +  forfree_lc +   
othercity_lc +  offhours_lc + asmrlc2018
, subset =  sex == "male")
summary(res_lc2016_male_gov_incomemod3)
vif(res_lc2016_male_gov_incomemod3)
step(res_lc2016_male_gov_incomemod3)


```

```{r cscrlc_work male}


res_lc2016_male_work_incomemod3 <- lm(data = lc2016_incomemod, cscr_worklc_2016 ~ 
                                        incomediffexpenceperpop_milyen_mod3 + incomediffexpenceperpop_milyen_mod3*haslimit_lc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_lc +  forfree_lc +   
othercity_lc +  offhours_lc + asmrlc2018
, subset =  sex == "male")
summary(res_lc2016_male_work_incomemod3)
vif(res_lc2016_male_work_incomemod3)
step(res_lc2016_male_work_incomemod3)

```



```{r}
lc2016data2016_male_incomemod3 <- tab_model(res_lc2016_male_total_incomemod3,res_lc2016_male_gov_incomemod3,res_lc2016_male_work_incomemod3,
                                            dv.labels = c("total_male","gov_male", "work_male"),
                      string.pred = "Coeffcient",
                      string.ci = "Conf. Int (95%)",
                      string.p = "P-Value", 
                      linebreak = TRUE,
                      digits = 3, digits.p = 2,
                      title = "crude screening rate (lc, 2016, income-kokko_quake), data = 2016",
                      file = "C:\\Users\\megme\\Documents\\cleaning variables\\lc2016data2016_male_incomemod3.html" )
lc2016data2016_male_incomemod3
```

    


# lc female ----
cscr_totallc_2016 + cscr_totallc_mod_2016 + cscr_govlc_2016 + cscr_govlc_mod_2016 +
cscr_worklc_2016 +    cscr_worklc_mod_2016 +cscr_otherlc_2016 + cscr_otherlc_mod_2016 +


incomediffexpenceperpop_milyen_mod3 + incomediffexpenceperpop_milyen_mod3*haslimit_lc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_lc +  forfree_lc +   
othercity_lc +  offhours_lc + asmrlc2018
 
```{r lm cscrlc_total female}

res_lc2016_female_total_incomemod3 <- lm(data = lc2016_incomemod, cscr_totallc_2016 ~ 
                                          incomediffexpenceperpop_milyen_mod3 + incomediffexpenceperpop_milyen_mod3*haslimit_lc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_lc +  forfree_lc +   
othercity_lc +  offhours_lc + asmrlc2018

,subset =  sex == "female")
summary(res_lc2016_female_total_incomemod3)
vif(res_lc2016_female_total_incomemod3)
step(res_lc2016_female_total_incomemod3)
```




```{r cscrlc_gov female}


res_lc2016_female_gov_incomemod3 <- lm(data = lc2016_incomemod, cscr_govlc_2016 ~ 
                                        incomediffexpenceperpop_milyen_mod3 + incomediffexpenceperpop_milyen_mod3*haslimit_lc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_lc +  forfree_lc +   
othercity_lc +  offhours_lc + asmrlc2018
, subset =  sex == "female")
summary(res_lc2016_female_gov_incomemod3)

vif(res_lc2016_female_gov_incomemod3)
step(res_lc2016_female_gov_incomemod3)


```

```{r cscrlc_work female}


res_lc2016_female_work_incomemod3 <- lm(data = lc2016_incomemod, cscr_worklc_2016 ~  
                                       incomediffexpenceperpop_milyen_mod3 + incomediffexpenceperpop_milyen_mod3*haslimit_lc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_lc +  forfree_lc +   
othercity_lc +  offhours_lc + asmrlc2018
, subset =  sex == "female")
summary(res_lc2016_female_work_incomemod3)
vif(res_lc2016_female_work_incomemod3)
step(res_lc2016_female_work_incomemod3)

```



```{r}
lc2016data2016_female_incomemod3 <- tab_model(res_lc2016_female_total_incomemod3,res_lc2016_female_gov_incomemod3,res_lc2016_female_work_incomemod3,
                                              dv.labels = c("total_female","gov_female", "work_female"),
                      string.pred = "Coeffcient",
                      string.ci = "Conf. Int (95%)",
                      string.p = "P-Value", 
                      linebreak = TRUE,
                      digits = 3, digits.p = 2,
                      title = "crude screening rate (lc, 2016, income-kokko_quake), data = 2016",
                      file = "C:\\Users\\megme\\Documents\\cleaning variables\\lc2016data2016_female_incomemod3.html" )
lc2016data2016_female_incomemod3
```
# crc male ----
cscr_totalcrc_2016 + cscr_totalcrc_mod_2016 + cscr_govcrc_2016 + cscr_govcrc_mod_2016 +
cscr_workcrc_2016 +    cscr_workcrc_mod_2016 +cscr_othercrc_2016 + cscr_othercrc_mod_2016 +


 incomediffexpenceperpop_milyen_mod3 + incomediffexpenceperpop_milyen_mod3*haslimit_crc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_crc +  forfree_crc +   
othercity_crc +  offhours_crc + asmrcrc2018


```{r lm cscrcrc_total male}

res_crc2016_male_total_incomemod3 <- lm(data = crc2016_incomemod, cscr_totalcrc_2016 ~ 
                              incomediffexpenceperpop_milyen_mod3 + incomediffexpenceperpop_milyen_mod3*haslimit_crc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_crc +  forfree_crc +   
othercity_crc +  offhours_crc + asmrcrc2018
,subset =  sex == "male")
summary(res_crc2016_male_total_incomemod3)
vif(res_crc2016_male_total_incomemod3)
step(res_crc2016_male_total_incomemod3)

```




```{r cscrcrc_gov male}


res_crc2016_male_gov_incomemod3 <- lm(data = crc2016_incomemod, cscr_govcrc_2016 ~  
                              incomediffexpenceperpop_milyen_mod3 + incomediffexpenceperpop_milyen_mod3*haslimit_crc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_crc +  forfree_crc +   
othercity_crc +  offhours_crc + asmrcrc2018
, subset =  sex == "male")
summary(res_crc2016_male_gov_incomemod3)
vif(res_crc2016_male_gov_incomemod3)
step(res_crc2016_male_gov_incomemod3)


```

```{r cscrcrc_work male}


res_crc2016_male_work_incomemod3 <- lm(data = crc2016_incomemod, cscr_workcrc_2016 ~ 
                                        incomediffexpenceperpop_milyen_mod3 + incomediffexpenceperpop_milyen_mod3*haslimit_crc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_crc +  forfree_crc +   
othercity_crc +  offhours_crc + asmrcrc2018
, subset =  sex == "male")
summary(res_crc2016_male_work_incomemod3)
vif(res_crc2016_male_work_incomemod3)
step(res_crc2016_male_work_incomemod3)

```



```{r}
crc2016data2016_male_incomemod3 <- tab_model(res_crc2016_male_total_incomemod3,res_crc2016_male_gov_incomemod3,res_crc2016_male_work_incomemod3,
                                             dv.labels = c("total_male","gov_male", "work_male"),
                      string.pred = "Coeffcient",
                      string.ci = "Conf. Int (95%)",
                      string.p = "P-Value", 
                      linebreak = TRUE,
                      digits = 3, digits.p = 2,
                      title = "crude screening rate (crc, 2016, income-kokko_quake), data = 2016",
                      file = "C:\\Users\\megme\\Documents\\cleaning variables\\crc2016data2016_male_incomemod3.html" )
crc2016data2016_male_incomemod3
```

    


# crc female ----
cscr_totalcrc_2016 + cscr_totalcrc_mod_2016 + cscr_govcrc_2016 + cscr_govcrc_mod_2016 +
cscr_workcrc_2016 +    cscr_workcrc_mod_2016 +cscr_othercrc_2016 + cscr_othercrc_mod_2016 +


incomediffexpenceperpop_milyen_mod3 + incomediffexpenceperpop_milyen_mod3*haslimit_crc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_crc +  forfree_crc +   
othercity_crc +  offhours_crc + asmrcrc2018
 
```{r lm cscrcrc_total female}

res_crc2016_female_total_incomemod3 <- lm(data = crc2016_incomemod, cscr_totalcrc_2016 ~ 
                                          incomediffexpenceperpop_milyen_mod3 + incomediffexpenceperpop_milyen_mod3*haslimit_crc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_crc +  forfree_crc +   
othercity_crc +  offhours_crc + asmrcrc2018

,subset =  sex == "female")
summary(res_crc2016_female_total_incomemod3)
vif(res_crc2016_female_total_incomemod3)
step(res_crc2016_female_total_incomemod3)
```




```{r cscrcrc_gov female}


res_crc2016_female_gov_incomemod3 <- lm(data = crc2016_incomemod, cscr_govcrc_2016 ~ 
                                        incomediffexpenceperpop_milyen_mod3 + incomediffexpenceperpop_milyen_mod3*haslimit_crc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_crc +  forfree_crc +   
othercity_crc +  offhours_crc + asmrcrc2018
, subset =  sex == "female")
summary(res_crc2016_female_gov_incomemod3)

vif(res_crc2016_female_gov_incomemod3)
step(res_crc2016_female_gov_incomemod3)


```

```{r cscrcrc_work female}


res_crc2016_female_work_incomemod3 <- lm(data = crc2016_incomemod, cscr_workcrc_2016 ~  
                                       incomediffexpenceperpop_milyen_mod3 + incomediffexpenceperpop_milyen_mod3*haslimit_crc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_crc +  forfree_crc +   
othercity_crc +  offhours_crc + asmrcrc2018
, subset =  sex == "female")
summary(res_crc2016_female_work_incomemod3)
vif(res_crc2016_female_work_incomemod3)
step(res_crc2016_female_work_incomemod3)

```



```{r}
crc2016data2016_female_incomemod3 <- tab_model(res_crc2016_female_total_incomemod3,res_crc2016_female_gov_incomemod3,res_crc2016_female_work_incomemod3,
                                               dv.labels = c("total_female","gov_female", "work_female"),
                      string.pred = "Coeffcient",
                      string.ci = "Conf. Int (95%)",
                      string.p = "P-Value", 
                      linebreak = TRUE,
                      digits = 3, digits.p = 2,
                      title = "crude screening rate (crc, 2016, income-kokko_quake), data = 2016",
                      file = "C:\\Users\\megme\\Documents\\cleaning variables\\crc2016data2016_female_incomemod3.html" )
crc2016data2016_female_incomemod3
```


# bc female ----
cscr_totalbc_2016 + cscr_totalbc_mod_2016 + cscr_govbc_2016 + cscr_govbc_mod_2016 +
cscr_workbc_2016 +    cscr_workbc_mod_2016 +cscr_otherbc_2016 + cscr_otherbc_mod_2016 +


incomediffexpenceperpop_milyen_mod3 + incomediffexpenceperpop_milyen_mod3*haslimit_bc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_bc +  forfree_bc +   
othercity_bc +  offhours_bc + asmrbc2018
 
```{r lm cscrbc_total female}

res_bc2016_female_total_incomemod3 <- lm(data = bc2016_incomemod, cscr_totalbc_2016 ~ 
                                          incomediffexpenceperpop_milyen_mod3 + incomediffexpenceperpop_milyen_mod3*haslimit_bc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_bc +  forfree_bc +   
othercity_bc +  offhours_bc + asmrbc2018

,subset =  sex == "female")
summary(res_bc2016_female_total_incomemod3)
vif(res_bc2016_female_total_incomemod3)
step(res_bc2016_female_total_incomemod3)
```




```{r cscrbc_gov female}


res_bc2016_female_gov_incomemod3 <- lm(data = bc2016_incomemod, cscr_govbc_2016 ~ 
                                        incomediffexpenceperpop_milyen_mod3 + incomediffexpenceperpop_milyen_mod3*haslimit_bc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_bc +  forfree_bc +   
othercity_bc +  offhours_bc + asmrbc2018
, subset =  sex == "female")
summary(res_bc2016_female_gov_incomemod3)

vif(res_bc2016_female_gov_incomemod3)
step(res_bc2016_female_gov_incomemod3)


```

```{r cscrbc_work female}


res_bc2016_female_work_incomemod3 <- lm(data = bc2016_incomemod, cscr_workbc_2016 ~  
                                       incomediffexpenceperpop_milyen_mod3 + incomediffexpenceperpop_milyen_mod3*haslimit_bc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_bc +  forfree_bc +   
othercity_bc +  offhours_bc + asmrbc2018
, subset =  sex == "female")
summary(res_bc2016_female_work_incomemod3)
vif(res_bc2016_female_work_incomemod3)
step(res_bc2016_female_work_incomemod3)

```



```{r}
bc2016data2016_female_incomemod3 <- tab_model(res_bc2016_female_total_incomemod3,res_bc2016_female_gov_incomemod3,res_bc2016_female_work_incomemod3,
                                              dv.labels = c("total_female","gov_female", "work_female"),
                      string.pred = "Coeffcient",
                      string.ci = "Conf. Int (95%)",
                      string.p = "P-Value", 
                      linebreak = TRUE,
                      digits = 3, digits.p = 2,
                      title = "crude screening rate (bc, 2016, income-kokko_quake), data = 2016",
                      file = "C:\\Users\\megme\\Documents\\cleaning variables\\bc2016data2016_female_incomemod3.html" )
bc2016data2016_female_incomemod3
```






#up20s----

```{r setting dataset}
merge1_incomemod <- merge(mergecscr_h28_up20, merged_variables4, by = c("pref","sex"), all = T) %>% 
  select(year,pref,sex, everything() )
names(merge1_incomemod)[5:44] %>% 
  paste0(., "_2016") ->names(merge1_incomemod)[5:44]


merge1_incomemod %>% 
  select( -contains("_lc"), -contains("lc_"),
          -contains("_crc"), -contains("crc_"),
          -contains("_gc"), -contains("gc_"),
          -contains("_bc"), -contains("bc_")) ->merge1_incomemod_cvc

merge1_incomemod_cvc %>% 
  filter(pref != "熊本") %>% 
  filter(year == "2016") -> cvc2016_incomemod

```

# cvc female ----
cscr_totalcvc_2016 + cscr_totalcvc_mod_2016 + cscr_govcvc_2016 + cscr_govcvc_mod_2016 +
cscr_workcvc_2016 +    cscr_workcvc_mod_2016 +cscr_othercvc_2016 + cscr_othercvc_mod_2016 +


incomediffexpenceperpop_milyen_mod3 + incomediffexpenceperpop_milyen_mod3*haslimit_cvc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_cvc +  forfree_cvc +   
othercity_cvc +  offhours_cvc + asmrcvc2018
 
```{r lm cscrcvc_total female}

res_cvc2016_female_total_incomemod3 <- lm(data = cvc2016_incomemod, cscr_totalcvc_2016 ~ 
                                          incomediffexpenceperpop_milyen_mod3 + incomediffexpenceperpop_milyen_mod3*haslimit_cvc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_cvc +  forfree_cvc +   
othercity_cvc +  offhours_cvc + asmrcvc2018

,subset =  sex == "female")
summary(res_cvc2016_female_total_incomemod3)
vif(res_cvc2016_female_total_incomemod3)
step(res_cvc2016_female_total_incomemod3)
```




```{r cscrcvc_gov female}


res_cvc2016_female_gov_incomemod3 <- lm(data = cvc2016_incomemod, cscr_govcvc_2016 ~ 
                                        incomediffexpenceperpop_milyen_mod3 + incomediffexpenceperpop_milyen_mod3*haslimit_cvc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_cvc +  forfree_cvc +   
othercity_cvc +  offhours_cvc + asmrcvc2018
, subset =  sex == "female")
summary(res_cvc2016_female_gov_incomemod3)

vif(res_cvc2016_female_gov_incomemod3)
step(res_cvc2016_female_gov_incomemod3)


```

```{r cscrcvc_work female}


res_cvc2016_female_work_incomemod3 <- lm(data = cvc2016_incomemod, cscr_workcvc_2016 ~  
                                       incomediffexpenceperpop_milyen_mod3 + incomediffexpenceperpop_milyen_mod3*haslimit_cvc +
safetynetperpop_milyen + pref_eiseihi_milyen + city_eiseihi_milyen +
GDP_milyen + 
gdpperperson_milyen + PD_1000perkm2 + elder_rate +midrate +
maritalrate + totalassets_pure + 
annualincome_milyen + haslimit_cvc +  forfree_cvc +   
othercity_cvc +  offhours_cvc + asmrcvc2018
, subset =  sex == "female")
summary(res_cvc2016_female_work_incomemod3)
vif(res_cvc2016_female_work_incomemod3)
step(res_cvc2016_female_work_incomemod3)

```



```{r}
cvc2016data2016_female_incomemod3 <- tab_model(res_cvc2016_female_total_incomemod3,res_cvc2016_female_gov_incomemod3,res_cvc2016_female_work_incomemod3,
                                               dv.labels = c("total_female","gov_female", "work_female"),
                      string.pred = "Coeffcient",
                      string.ci = "Conf. Int (95%)",
                      string.p = "P-Value", 
                      linebreak = TRUE,
                      digits = 3, digits.p = 2,
                      title = "crude screening rate (cvc, 2016, income-kokko_quake), data = 2016",
                      file = "C:\\Users\\megme\\Documents\\cleaning variables\\cvc2016data2016_female_incomemod3.html" )
cvc2016data2016_female_incomemod3
```




